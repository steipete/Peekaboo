---
summary: "Working log for AXorcist boundary follow-ups (Nov 19, 2025)."
read_when:
  - "tracking AXorcist/Peekaboo accessibility refactor progress"
  - "assigning next tasks for AX toolkit/Peekaboo separation"
---

# AXorcist Refactor Work List â€” Nov 19, 2025

## âœ… Done recently
- InputDriver now powers all click/drag/scroll/hotkey usage from Peekaboo; direct CGEvents removed.
- SwiftLint rule warns on AXUIElement/CGEvent in Peekaboo UI services.
- WindowIdentityUtilities delegates to AXWindowResolver; MouseLocationUtilities delegates to AppLocator.
- CaptureOutput/SCS stream path has bounded timeout + DEBUG hooks; CLI tests pass.
- Screen capture fallback logs engine + duration; env/flag control (`--capture-engine`, `PEEKABOO_CAPTURE_ENGINE`, `PEEKABOO_DISABLE_CGWINDOWLIST`).
- Timeout helper (`AXTimeoutHelper`) moved into AXorcist; shared with Peekaboo.
- AXorcist tests now cover InputDriver, AppLocator, AXWindowResolver, and timeout behavior.
- Tool filtering allow/deny now documented + tested (PeekabooAgentRuntime + docs).

## ðŸŽ¯ Remaining tasks
1. **AX facade adoption** (in progress)
   - Scrub remaining direct AXUIElement calls (UIAutomationService, UIAXHelpers, DialogService `AXSheets`/`AXWindows`, tests).
   - Switch to `AXApp`/`AXWindowHandle` everywhere; ensure helper tests (FocusUtilities, etc.) use the facades.
2. **CG fallback tightening** (partial)
   - Now controlled via flag/env; still need an opt-in observer or telemetry for CLI output if desired.
   - Once scrub completes, flip SwiftLint custom rule from warning â†’ error.
3. **AXorcist observability hook** (done via fallback runner logging) â€” optional follow-up: expose a public `ScreenCaptureMetricsObserving` if we decide to ship metrics beyond logging; otherwise, remove TODO references.
4. **Documentation cleanup**
   - Update README/docs to mention capture-engine flag/env (done in README/config docs) and new security guidance (tools allow/deny). Keep doc parity in future releases.
5. **Future nice-to-haves**
   - Evaluate removing `CGWindowListCreateImage` entirely once SC reliability is proven.
   - Consider public API surface for peekaboo-specific heuristics (e.g., `AXWindowScore` objects) if we need cross-tool reuse.

## Tracking
- Owner: Peekaboo core team (AX boundary).
- Repo: Peekaboo + AXorcist (submodule).
- Next update checkpoint: after lint is tightened and remaining AXUIElement references are gone.
